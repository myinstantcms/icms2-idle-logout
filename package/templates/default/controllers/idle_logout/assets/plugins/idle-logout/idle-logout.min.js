function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}!function(o){var t;t={settings:{logoutSeconds:300,countdownSeconds:30,countdownMessage:"Вы выйдите с сайта через {countdown} секунд.",logoutUrl:"/auth/logout",cookieOptions:{path:"/"},updateMilliseconds:300,bindEvents:"mousemove mousedown mouseup keydown keyup focus blur"},idleTime:null,logoutTime:null,idleTimeout:null,logoutTimeout:null,countdownInterval:null,countingDown:!1,$countdownDialog:null,$countdownText:null,handlers:{UserActivity:function(o){t.countingDown||t._reset()},UserIdle:function(o){t._inSyncWithCookie()?t._startCountdown():t._reset(t._getCookie())},IdleLogout:function(o){window.location.href=t.settings.logoutUrl},CancelLogout:function(o){t._stopCountdown(),t._reset()},IdleDialogUpdate:function(o){t._inSyncWithCookie()?t._updateCountdown():(t._stopCountdown(),t._reset(t._getCookie()))}},init:function(n){t.settings=o.extend(t.settings,n),o(document).bind(t.settings.bindEvents,function(t){o(document).trigger("UserActivity.idleLogout",t)}),o.each(t.handlers,function(t,n){o(document).bind(t+".idleLogout",n)}),t._reset()},_reset:function(n){var e=(new Date).getTime(),i=t.logoutTime=n||e+1e3*t.settings.logoutSeconds,u=i-e,l=u-1e3*t.settings.countdownSeconds;t.logoutTimeout&&window.clearTimeout(t.logoutTimeout),t.idleTimeout&&window.clearTimeout(t.idleTimeout),t.logoutTimeout=window.setTimeout(function(){o(document).trigger("IdleLogout.idleLogout")},u),t.idleTimeout=window.setTimeout(function(){o(document).trigger("UserIdle.idleLogout")},l),void 0===n&&t._setCookie(i)},_setCookie:function(n){o.cookie("idleLogout.logoutTime",n,t.settings.cookieOptions)},_getCookie:function(){return window.parseInt(o.cookie("idleLogout.logoutTime"))},_inSyncWithCookie:function(){var o=t._getCookie();return t.logoutTime===o},_startCountdown:function(){t.countingDown=!0;var n=t.settings.countdownMessage.replace("{countdown}",'<span id="countdown-timer" class="countdown-timer"></span>');swal({html:n,type:"question",confirmButtonColor:"#3085d6",confirmButtonText:"Отменить выход!"}).then(function(){o(document).trigger("CancelLogout.idleLogout")}),t.$countdownText=o("#countdown-timer"),t.countdownInterval=window.setInterval(function(){o(document).trigger("IdleDialogUpdate.idleLogout")},t.settings.updateMilliseconds)},_stopCountdown:function(){t.countdownInterval&&window.clearInterval(t.countdownInterval),t.countingDown=!1},_updateCountdown:function(){var o=Math.ceil((t.logoutTime-(new Date).getTime())/1e3);t.$countdownText.text(o)}},o.idleLogout=function(n){return t[n]&&"_"!==n.substr(0,1)?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==_typeof(n)&&n?void o.error("Method "+n+" does not exist on jQuery.idleLogout"):t.init.apply(this,arguments)}}(jQuery);
